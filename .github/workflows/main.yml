name: Wake Up Streamlit App (Playwright Version)

on:
  schedule:
    - cron: '0 */6 * * *' # ‡∏õ‡∏•‡∏∏‡∏Å‡∏ó‡∏∏‡∏Å 6 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
  workflow_dispatch:

jobs:
  wake_up:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: |
          pip install playwright
          playwright install chromium

      - name: Open App and Wait (Simulate Human)
        run: |
          python -c "
          from playwright.sync_api import sync_playwright
          import time

          with sync_playwright() as p:
              # ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÅ‡∏ö‡∏ö‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ (Headless)
              browser = p.chromium.launch()
              page = browser.new_page()
              
              print('üöÄ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏õ...')
              # ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL_HERE ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏≠‡∏õ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π
              page.goto('https://patwitpolice.streamlit.app/')
              
              # ‡∏£‡∏≠ 15 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ WebSocket ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏≠‡∏õ‡πÄ‡∏£‡∏¥‡πà‡∏° Boot
              print('‚è≥ ‡∏£‡∏≠‡∏£‡∏∞‡∏ö‡∏ö Boot 15 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ...')
              time.sleep(15)
              
              # ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡∏î‡∏π (Optional - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡πá‡∏Å‡πÉ‡∏ô Action logs)
              page.screenshot(path='app_status.png')
              print('‚úÖ ‡∏õ‡∏•‡∏∏‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!')
              browser.close()
          "
      # (Optional) ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ Green ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏∏‡∏Å
      - name: Upload screenshot
        uses: actions/upload-artifact@v4
        with:
          name: app-status-screenshot
          path: app_status.png
